<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Pantry Pad</title>
<style>
:root{
  --bg:#f6f7fb; --card:#fff; --line:#e5e7eb; --shadow:0 8px 22px rgba(0,0,0,.10);
  --radius:18px; --gap:14px; --brand:#6a5cff; --brand2:#20c997; --danger:#ff8a80;
}
*{box-sizing:border-box} body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:#222;transition:background .3s,color .3s}
body.dark{--bg:#1e1e1e;--card:#2a2a2a;--line:#444;--shadow:0 6px 18px rgba(0,0,0,.6);color:#eee}

/* HOME */
.home{min-height:100vh;display:grid;gap:22px;grid-auto-rows:min-content;place-content:center;padding:26px;background:linear-gradient(135deg,#6a5cff 0%,#20c997 100%);color:#fff;text-align:center}
.home h1{margin:0 0 6px;font-size:1.9rem}
.subtitle{opacity:.9;margin:0 0 12px}
.choices{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));width:min(900px,96vw);margin:0 auto}
.choice{display:flex;align-items:center;gap:12px;padding:18px;border-radius:16px;border:none;cursor:pointer;background:#fff;color:#222;box-shadow:var(--shadow);font-size:1.05rem;text-align:left}
.choice .icon{font-size:1.6rem}
.choice.view{border-left:10px solid var(--brand2)}
.choice.shop{border-left:10px solid #ff7ab6}
.choice.dash{border-left:10px solid #66d9e8}
.choice.market{border-left:10px solid #ffd43b}
.choice.edit{border-left:10px solid var(--brand)}
.choice.book{border-left:10px solid #ffa94d}
.choice.settings{border-left:10px solid #888}

/* HEADER */
header{display:flex;gap:10px;align-items:center;padding:10px 12px;background:#fff;box-shadow:var(--shadow);position:sticky;top:0;z-index:8}
header h1{margin:0;font-size:1.1rem}
header input,header select{flex:1;padding:10px 12px;border:1px solid var(--line);border-radius:10px;font-size:1rem}
header button{padding:10px 12px;border:none;border-radius:10px;background:var(--brand);color:#fff;font-size:1rem;white-space:nowrap}
header .ghost{background:#fff;color:#333;border:1px solid var(--line)}
.wrap{display:grid;grid-template-columns:240px 1fr;min-height:calc(100vh - 60px)}
aside{background:#fff;border-right:1px solid var(--line);padding:12px}
.aside-title{font-weight:600;margin:4px 0 10px 2px}
.cat-list{display:flex;flex-direction:column;gap:8px}
.cat{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#fafafa;cursor:pointer}
.cat.active{background:#eaf2ff;border-color:#bcd4ff}
main{padding:14px}
.grid{display:grid;gap:var(--gap);grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}
.tile{position:relative;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;border:1px solid var(--line)}
.imgwrap{width:100%;aspect-ratio:1/1;background:#eee;display:flex;align-items:center;justify-content:center;overflow:hidden}
.tile img{width:100%;height:100%;object-fit:cover}
.body{padding:12px}
.name{font-weight:700;line-height:1.2}
.meta{font-size:.92rem;color:#555;margin-top:6px}
.ribbon{position:absolute;top:10px;left:10px;padding:6px 8px;border-radius:10px;font-size:.8rem;background:#fff3cd;color:#7a4e00;box-shadow:var(--shadow)}
.ribbon.exp{background:#fde2e0;color:#8b1a1a}
.quick{display:flex;gap:6px;margin-top:10px}
.quick button{flex:1;border:1px solid var(--line);background:#fff;border-radius:10px;padding:8px 10px}
.footerbar{display:flex;gap:10px;padding:12px;border-top:1px solid var(--line);background:#fff;position:sticky;bottom:0;z-index:7}
.footerbar small{color:#666;margin-left:auto}
.empty{text-align:center;color:#777;padding:40px}

/* Pages */
.page{padding:16px}
.section-title{font-weight:800;margin:10px 0 12px;font-size:1.2rem}
.stat{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px;box-shadow:var(--shadow);margin-bottom:10px}

/* Dialog */
dialog{width:min(560px,96vw);border:none;border-radius:18px;padding:0;box-shadow:var(--shadow)}
dialog header,dialog footer{padding:12px 16px}
dialog header{border-bottom:1px solid var(--line)}
dialog form{padding:16px;display:grid;gap:10px}
dialog input,dialog textarea,dialog select{padding:10px 12px;border:1px solid var(--line);border-radius:10px;font-size:1rem}
dialog footer{border-top:1px solid var(--line);display:flex;justify-content:flex-end;gap:8px}
.danger{background:var(--danger);color:#fff;border:none}
.primary{background:var(--brand2);color:#fff;border:none}
.ghost2{background:#fff;border:1px solid var(--line)}

/* AI Figures */
.ai-side{position:fixed;top:50%;transform:translateY(-50%);z-index:5;pointer-events:none;text-align:center}
.ai-left{left:6px}
.ai-right{right:6px}
.ai-fig{width:72px;height:72px;border-radius:50%;overflow:hidden;box-shadow:0 6px 20px rgba(0,0,0,.25);background:#fff;border:2px solid #fff;animation:blink 4s infinite}
@keyframes blink{0%,90%,100%{transform:scale(1)}95%{transform:scaleY(.8)}}
.ai-speech{margin-top:8px;max-width:180px;background:#fff;border:1px solid var(--line);border-radius:12px;box-shadow:var(--shadow);padding:8px 10px;font-size:.9rem;color:#333;display:none}

/* Flags */
.flag{width:20px;height:14px;vertical-align:middle;margin-right:4px}
</style>
</head>
<body>
<!-- HOME -->
<section id="home" class="home">
  <div style="display:flex;justify-content:flex-end;gap:10px;margin-bottom:10px">
    <select id="langHome">
      <option value="de">üá©üá™ Deutsch</option>
      <option value="en">üá¨üáß English</option>
      <option value="tr">üáπüá∑ T√ºrk√ße</option>
    </select>
    <button id="loginBtn" class="ghost">üîë Login</button>
  </div>
  <h1>üëã Willkommen im Pantry Pad</h1>
  <p class="subtitle">Was m√∂chtest du tun?</p>
  <div class="choices" id="homeChoices"></div>
</section>

<!-- App Shell -->
<section id="app" hidden>
  <header>
    <button id="backHome" class="ghost">üè†</button>
    <h1 id="appTitle">Pantry Pad</h1>
    <input id="q" placeholder="Suchen ‚Ä¶"/>
    <select id="locFilter"><option value="">Alle Orte</option><option>Vorratsschrank</option><option>K√ºhlschrank</option><option>Gefrierfach</option></select>
    <button id="add">+ Produkt</button>
    <select id="lang"><option value="de">üá©üá™</option><option value="en">üá¨üáß</option><option value="tr">üáπüá∑</option></select>
  </header>
  <div class="wrap">
    <aside><div class="aside-title" id="catTitle">Kategorien</div><div id="cats" class="cat-list"></div></aside>
    <main><div id="grid" class="grid"></div><div id="empty" class="empty" hidden>Keine Produkte.</div></main>
  </div>
  <div class="footerbar">
    <button id="export" class="ghost2">‚¨áÔ∏è Export</button>
    <button id="importBtn" class="ghost2">‚¨ÜÔ∏è Import</button>
    <input id="importFile" type="file" accept="application/json" style="display:none">
    <label>Warnung in <input id="soonDays" type="number" min="1" max="90" value="14" style="width:64px"> Tagen</label>
  </div>
</section>

<!-- weitere Seiten (Shop, Dashboard, M√§rkte, Kochbuch, Settings etc.) -->
<!-- ... der restliche JavaScript-Teil w√§re hier sehr umfangreich -->

</body>
</html><script>
/* ===== I18N (√úbersetzungen) ===== */
const I18N={
  de:{title:'Pantry Pad',none:'Keine Produkte.','expired':'Abgelaufen',soon:n=>`Bald (${n}T)`,mhd:d=>`MHD: ${d}`},
  en:{title:'Pantry Pad',none:'No items.','expired':'Expired',soon:n=>`Soon (${n}d)`,mhd:d=>`Exp: ${d}`},
  tr:{title:'Kiler Paneli',none:'√úr√ºn yok.','expired':'S√ºresi ge√ßti',soon:n=>`Yakƒ±nda (${n}g)`,mhd:d=>`SKT: ${d}`}
};
let LANG=localStorage.getItem('pantry-lang')||'de';
let IS_ADMIN=false;

/* ===== IndexedDB (Speicher) ===== */
const DB='pantry-db-v3', STORE='items'; let db;
const openDB=()=>new Promise((res,rej)=>{const r=indexedDB.open(DB,1); r.onupgradeneeded=()=>r.result.createObjectStore(STORE,{keyPath:'id'}); r.onsuccess=()=>{db=r.result;res();}; r.onerror=()=>rej(r.error);});
const st=(m='readonly')=>db.transaction(STORE,m).objectStore(STORE);
const getAll=()=>new Promise((res,rej)=>{const q=st().getAll(); q.onsuccess=()=>res(q.result||[]); q.onerror=()=>rej(q.error);});
const put=(it)=>new Promise((res,rej)=>{const q=st('readwrite').put(it); q.onsuccess=()=>res(); q.onerror=()=>rej(q.error);});
const delItem=(id)=>new Promise((res,rej)=>{const q=st('readwrite').delete(id); q.onsuccess=()=>res(); q.onerror=()=>rej(q.error);});

/* ===== Hilfsfunktionen ===== */
const esc=s=>s?.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))||'';
const daysUntil=ds=>{if(!ds) return null; const n=new Date(); n.setHours(0,0,0,0); const d=new Date(ds+'T00:00:00'); return Math.floor((d-n)/86400000);};
function seedImage(emoji,bg){const svg=encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'><rect width='100%' height='100%' rx='40' ry='40' fill='${bg}'/><text x='50%' y='55%' text-anchor='middle' font-size='400'>${emoji}</text></svg>`);return `data:image/svg+xml;charset=utf-8,${svg}`;}

/* ===== Startseite (Kacheln) ===== */
function buildHome(){
  const wrap=document.getElementById('homeChoices'); wrap.innerHTML='';
  const base=[
    {id:'inventory-view',icon:'üëÄ',title:'Nachschauen'},
    {id:'shop',icon:'üõí',title:'Einkaufsliste'},
    {id:'dashboard',icon:'üìä',title:'Dashboard'},
    {id:'markets',icon:'üè™',title:'Superm√§rkte'},
  ];
  const admin=[
    {id:'inventory-edit',icon:'‚úèÔ∏è',title:'Bearbeiten'},
    {id:'cookbook',icon:'üìñ',title:'Kochbuch'},
    {id:'settings',icon:'‚öôÔ∏è',title:'Einstellungen'}
  ];
  const all=IS_ADMIN?[...base,...admin]:base;
  all.forEach(c=>{
    const btn=document.createElement('button'); btn.className='choice'; btn.dataset.go=c.id;
    btn.innerHTML=`<span class="icon">${c.icon}</span><span><strong>${c.title}</strong></span>`;
    btn.onclick=()=>go(c.id); wrap.appendChild(btn);
  });
}

/* ===== Inventar-Ansicht ===== */
async function renderInventory(){
  const all=await getAll();
  const grid=document.getElementById('grid'), empty=document.getElementById('empty');
  grid.innerHTML='';
  const items=all.filter(i=>!i.archived);
  if(!items.length){ empty.hidden=false; empty.textContent=I18N[LANG].none; return; }
  empty.hidden=true;
  items.forEach(it=>{
    const d=daysUntil(it.mhd);
    const soon=d!==null && d>=0 && d<=Number(document.getElementById('soonDays').value||14);
    const exp=d!==null && d<0;
    const card=document.createElement('div'); card.className='tile';
    const img=document.createElement('img'); img.src=it.imgData||it.imgUrl||seedImage('üì¶','#eee'); img.className='imgwrap'; card.appendChild(img);
    if(soon||exp){ const r=document.createElement('div'); r.className='ribbon'+(exp?' exp':''); r.textContent=exp?I18N[LANG].expired:I18N[LANG].soon(d); card.appendChild(r);}
    const body=document.createElement('div'); body.className='body';
    body.innerHTML=`<div class="name">${esc(it.name)}</div><div class="meta">${it.qty||0} ${it.unit||''} ${it.mhd?I18N[LANG].mhd(it.mhd):''}</div>`;
    if(IS_ADMIN){
      const qdiv=document.createElement('div'); qdiv.className='quick';
      ['-1','+1'].forEach(sym=>{
        const b=document.createElement('button'); b.textContent=sym; b.onclick=async()=>{it.qty=(it.qty||0)+(sym==='+1'?1:-1); if(it.qty<0) it.qty=0; await put(it); renderInventory();}; qdiv.appendChild(b);
      });
      body.appendChild(qdiv);
    }
    card.appendChild(body); grid.appendChild(card);
  });
}

/* ===== Einkaufsliste ===== */
async function renderShop(){
  const all=await getAll(); const list=document.getElementById('shopList'); list.innerHTML='';
  const items=all.filter(i=>(i.qty||0)===0);
  if(!items.length){ list.innerHTML='<p>Alles da ‚úÖ</p>'; return; }
  items.forEach(it=>{
    const row=document.createElement('div'); row.className='stat'; row.textContent=it.name;
    if(IS_ADMIN){ const b=document.createElement('button'); b.textContent='‚úÖ'; b.onclick=async()=>{it.qty=1; await put(it); renderShop(); renderInventory();}; row.appendChild(b);}
    list.appendChild(row);
  });
}

/* ===== Dashboard ===== */
async function renderDash(){
  const all=await getAll();
  const soonList=document.getElementById('soonList'), expList=document.getElementById('expList'), total=document.getElementById('totalStat');
  const soon=all.filter(i=>{const d=daysUntil(i.mhd);return d!==null&&d>=0&&d<=14;});
  const exp=all.filter(i=>{const d=daysUntil(i.mhd);return d!==null&&d<0;});
  soonList.innerHTML=soon.map(i=>'‚Ä¢ '+i.name).join('<br>')||'‚Äî';
  expList.innerHTML=exp.map(i=>'‚Ä¢ '+i.name).join('<br>')||'‚Äî';
  total.textContent='Gesamt: '+all.length;
}

/* ===== Superm√§rkte ===== */
function renderMarkets(){
  const markets=[
    {name:'Lidl',icon:'üü°',link:'https://www.lidl.de/c/angebote'},
    {name:'Aldi',icon:'üî∑',link:'https://www.aldi.de'},
    {name:'Rewe',icon:'üü•',link:'https://www.rewe.de/angebote'},
    {name:'Action',icon:'üü£',link:'https://www.action.com/de-de'},
    {name:'T√ºrkischer Markt',icon:'üïå',link:'#'}
  ];
  const grid=document.getElementById('marketGrid'); grid.innerHTML='';
  markets.forEach(m=>{
    const card=document.createElement('div'); card.className='tile';
    card.innerHTML=`<div class="imgwrap">${m.icon}</div><div class="body"><div class="name">${m.name}</div><a href="${m.link}" target="_blank">Prospekt ‚ñ∂Ô∏è</a></div>`;
    grid.appendChild(card);
  });
}

/* ===== Navigation ===== */
function go(where){
  ['home','app','shopPage','dashPage','marketPage','cookPage','settingsPage'].forEach(id=>document.getElementById(id)?.setAttribute('hidden',true));
  if(where==='home'){document.getElementById('home').hidden=false; buildHome();}
  if(where==='inventory-view'||where==='inventory-edit'){document.getElementById('app').hidden=false; renderInventory();}
  if(where==='shop'){document.getElementById('shopPage').hidden=false; renderShop();}
  if(where==='dashboard'){document.getElementById('dashPage').hidden=false; renderDash();}
  if(where==='markets'){document.getElementById('marketPage').hidden=false; renderMarkets();}
  if(where==='cookbook'){document.getElementById('cookPage').hidden=false; renderCook();}
  if(where==='settings'){document.getElementById('settingsPage').hidden=false;}
}

/* ===== Login ===== */
document.getElementById('loginBtn').onclick=()=>{
  const pin=prompt('Admin PIN eingeben (z.B. 1234):');
  if(pin==='1234'){IS_ADMIN=true;alert('Admin-Modus aktiviert');buildHome();}
  else{alert('Falsch');}
};

/* ===== Sprache √§ndern ===== */
document.getElementById('langHome').onchange=e=>{LANG=e.target.value;localStorage.setItem('pantry-lang',LANG);buildHome();renderInventory();}
document.getElementById('lang').onchange=e=>{LANG=e.target.value;localStorage.setItem('pantry-lang',LANG);renderInventory();}

/* ===== Init ===== */
(async()=>{await openDB();buildHome();})();
</script><script>
/* ===== Kochbuch ===== */
const RECIPES=[
  {id:'r1',title:'Menemen',video:'https://www.youtube.com/results?search_query=menemen+sally',
   ingredients:['Eier','Tomaten','Paprika','√ñl','Salz']},
  {id:'r2',title:'Pfannkuchen',video:'https://www.youtube.com/results?search_query=pfannkuchen+sally',
   ingredients:['Mehl','Milch','Ei','Zucker']}
];
function renderCook(){
  const grid=document.getElementById('recipesGrid'); grid.innerHTML='';
  RECIPES.forEach(r=>{
    const card=document.createElement('div'); card.className='tile';
    card.innerHTML=`<div class="imgwrap">üç≥</div><div class="body"><div class="name">${r.title}</div><a href="${r.video}" target="_blank">‚ñ∂Ô∏è Video</a></div>`;
    grid.appendChild(card);
  });
}

/* ===== Settings ===== */
function renderSettings(){
  const box=document.getElementById('settingsBox');
  box.innerHTML=`
    <div class="stat"><strong>Theme</strong><br>
      <button onclick="document.body.classList.toggle('dark')">üåô Dark Mode</button>
    </div>
    <div class="stat"><strong>Senior-Modus</strong><br>
      <button onclick="toggleSenior()">üëµ Einfach Ansicht</button>
    </div>
    <div class="stat"><strong>Assistenten</strong><br>
      <button onclick="toggleAI()">ü§ñ Figuren an/aus</button>
    </div>
  `;
}
function toggleSenior(){document.body.classList.toggle('senior');}
function toggleAI(){document.getElementById('aiIlyan').hidden=!document.getElementById('aiIlyan').hidden;
                    document.getElementById('aiLiaz').hidden=!document.getElementById('aiLiaz').hidden;}

/* ===== AI Figuren ===== */
function drawAvatar(el,name,color){
  const m=new Date().getMonth()+1;
  let acc=''; if([12,1,2].includes(m))acc='üß£'; if([6,7,8].includes(m))acc='üï∂Ô∏è'; if([9,10].includes(m))acc='üçÅ';
  el.innerHTML=`<svg viewBox="0 0 100 100" width="72" height="72">
    <circle cx="50" cy="50" r="48" fill="${color}"/>
    <text x="50" y="55" text-anchor="middle" font-size="36">üòä</text>
    <text x="85" y="25" font-size="20">${acc}</text>
  </svg>`;
}
const LINES_I=['Ich checke dein MHD üëÄ','Bald l√§uft was ab','Schau in den K√ºhlschrank!'];
const LINES_L=['Ich mach die Liste üõí','Milch fehlt?','Zeit f√ºr den Einkauf!'];
function rotateLines(){
  document.getElementById('msgIlyan').textContent=LINES_I[Math.floor(Math.random()*LINES_I.length)];
  document.getElementById('msgLiaz').textContent=LINES_L[Math.floor(Math.random()*LINES_L.length)];
}
setInterval(rotateLines,8000);

/* ===== Sprachsteuerung (Browser SpeechRecognition) ===== */
function startSpeech(){
  const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(!SpeechRecognition)return alert('Keine Sprachsteuerung im Browser');
  const rec=new SpeechRecognition(); rec.lang=(LANG==='tr'?'tr-TR':LANG==='en'?'en-US':'de-DE');
  rec.onresult=async e=>{
    const t=e.results[0][0].transcript.toLowerCase();
    alert('Erkannt: '+t);
    if(t.includes('milch')){await put({id:crypto.randomUUID(),name:'Milch',qty:1,unit:'Pack'});renderInventory();}
  };
  rec.start();
}

/* ===== Barcode Scanner (Platzhalter) ===== */
function startScanner(){
  alert('üì∑ Barcode-Scanner hier einf√ºgen (QuaggaJS o.√§.)');
}

/* ===== DOM f√ºr Zusatzseiten ===== */
document.body.insertAdjacentHTML('beforeend',`
<!-- Kochbuch -->
<section id="cookPage" class="page" hidden>
  <header><button class="ghost" onclick="go('home')">üè†</button><h1>üìñ Kochbuch</h1></header>
  <div id="recipesGrid" class="grid"></div>
</section>

<!-- Settings -->
<section id="settingsPage" class="page" hidden>
  <header><button class="ghost" onclick="go('home')">üè†</button><h1>‚öôÔ∏è Einstellungen</h1></header>
  <div id="settingsBox"></div>
</section>

<!-- AI Figuren -->
<div id="aiIlyan" class="ai-side ai-left"><div class="ai-fig" id="avIlyan"></div><div id="msgIlyan" class="ai-speech">Hallo</div></div>
<div id="aiLiaz" class="ai-side ai-right"><div class="ai-fig" id="avLiaz"></div><div id="msgLiaz" class="ai-speech">Hi</div></div>

<!-- Sprachsteuerung & Barcode -->
<div style="position:fixed;bottom:10px;left:50%;transform:translateX(-50%);z-index:9">
  <button onclick="startSpeech()">üé§ Sprache</button>
  <button onclick="startScanner()">üì∑ Barcode</button>
</div>
`);

/* ===== Init Figuren + Settings ===== */
drawAvatar(document.getElementById('avIlyan'),'Ilyan','#74c0fc');
drawAvatar(document.getElementById('avLiaz'),'Liaz','#69db7c');
renderSettings(); rotateLines();
</script>
</body></html>
